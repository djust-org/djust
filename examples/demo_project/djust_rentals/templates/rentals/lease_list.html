{% extends "rentals/base.html" %}

{% block title %}Leases - Rental Management{% endblock %}

{% block content %}
<div class="py-6" dj-root dj-view="djust_rentals.views.leases.LeaseListView">
  <div class="container mx-auto px-4 max-w-7xl">
    <!-- Page Header with Lucide Icon and Add Button -->
    {{ page_header|safe }}

    <!-- Search and Filters -->
    <div class="bg-card border border-border rounded-lg p-6 mb-6">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <!-- Search -->
        <div>
          <label class="block text-sm font-medium text-muted-foreground mb-2">
            <div class="flex items-center gap-1">
              <i data-lucide="search" class="w-4 h-4"></i>
              Search Leases
            </div>
          </label>
          <input type="text"
                 dj-input="search"
                 value="{{ search_query }}"
                 placeholder="Search by property or tenant..."
                 class="w-full px-3 py-2 bg-background border border-input rounded-md text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent">
        </div>

        <!-- Status Filter -->
        <div>
          <label class="block text-sm font-medium text-muted-foreground mb-2">
            <div class="flex items-center gap-1">
              <i data-lucide="filter" class="w-4 h-4"></i>
              Status
            </div>
          </label>
          <select dj-change="filter_by_status"
                  class="w-full px-3 py-2 bg-background border border-input rounded-md text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent">
            <option value="all" {% if filter_status == 'all' %}selected{% endif %}>All Statuses</option>
            {% for val, label in status_choices %}
            <option value="{{ val }}" {% if filter_status == val %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
          </select>
        </div>

        <!-- Sort By -->
        <div>
          <label class="block text-sm font-medium text-muted-foreground mb-2">
            <div class="flex items-center gap-1">
              <i data-lucide="arrow-up-down" class="w-4 h-4"></i>
              Sort By
            </div>
          </label>
          <select dj-change="sort_leases"
                  class="w-full px-3 py-2 bg-background border border-input rounded-md text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent">
            <option value="end_date" {% if sort_by == 'end_date' %}selected{% endif %}>End Date</option>
            <option value="start_date" {% if sort_by == 'start_date' %}selected{% endif %}>Start Date</option>
            <option value="rent" {% if sort_by == 'rent' %}selected{% endif %}>Monthly Rent</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Summary Stats - Using StatCard Components -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
      {% for stat_card in stat_cards %}
        {{ stat_card|safe }}
      {% endfor %}
    </div>

    <!-- Leases Table - Using DataTable Component -->
    {{ lease_table|safe }}
  </div>
</div>
{% endblock %}
