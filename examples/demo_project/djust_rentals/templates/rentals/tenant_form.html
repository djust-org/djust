{% extends "rentals/base.html" %}

{% block title %}{% if is_edit %}Edit{% else %}Add{% endif %} Tenant{% endblock %}

{% block content %}
<div class="py-6" data-djust-root data-djust-view="djust_rentals.views.tenants.TenantFormView">
  <div class="container mx-auto px-4 max-w-3xl">
    <!-- Page Header -->
    {{ page_header|safe }}

    {% if success_message %}
    <div class="bg-green-500/10 border border-green-500/20 text-green-600 dark:text-green-400 px-4 py-3 rounded-lg mb-6 flex items-center gap-2">
      <i data-lucide="check-circle" class="w-5 h-5"></i>
      <span>{{ success_message }}</span>
    </div>
    {% endif %}

    {% if error_message %}
    <div class="bg-destructive/10 border border-destructive text-destructive-foreground px-4 py-3 rounded-lg mb-6 flex items-center gap-2">
      <i data-lucide="alert-circle" class="w-5 h-5"></i>
      <span>{{ error_message }}</span>
    </div>
    {% endif %}

    <form dj-submit="save_tenant" class="bg-card border border-border rounded-lg p-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- First Name -->
        <div>
          <label class="block text-sm font-medium text-card-foreground mb-1">
            First Name <span class="text-destructive">*</span>
          </label>
          <input
            type="text"
            name="first_name"
            class="w-full bg-background border border-input rounded-md px-3 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent"
            value="{% if tenant %}{{ tenant.user.first_name }}{% endif %}"
            required
          />
        </div>

        <!-- Last Name -->
        <div>
          <label class="block text-sm font-medium text-card-foreground mb-1">
            Last Name <span class="text-destructive">*</span>
          </label>
          <input
            type="text"
            name="last_name"
            class="w-full bg-background border border-input rounded-md px-3 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent"
            value="{% if tenant %}{{ tenant.user.last_name }}{% endif %}"
            required
          />
        </div>

        <!-- Email -->
        <div>
          <label class="block text-sm font-medium text-card-foreground mb-1">
            Email <span class="text-destructive">*</span>
          </label>
          <div class="relative">
            <i data-lucide="mail" class="w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"></i>
            <input
              type="email"
              name="email"
              class="w-full bg-background border border-input rounded-md pl-10 pr-3 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent {% if tenant %}opacity-75{% endif %}"
              value="{% if tenant %}{{ tenant.user.email }}{% endif %}"
              required
              {% if tenant %}readonly{% endif %}
            />
          </div>
          {% if tenant %}
          <p class="text-xs text-muted-foreground mt-1">Email cannot be changed after creation</p>
          {% endif %}
        </div>

        <!-- Phone -->
        <div>
          <label class="block text-sm font-medium text-card-foreground mb-1">
            Phone <span class="text-destructive">*</span>
          </label>
          <div class="relative">
            <i data-lucide="phone" class="w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"></i>
            <input
              type="tel"
              name="phone"
              class="w-full bg-background border border-input rounded-md pl-10 pr-3 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent"
              value="{% if tenant %}{{ tenant.phone }}{% endif %}"
              required
            />
          </div>
        </div>

        <!-- Emergency Contact Name -->
        <div>
          <label class="block text-sm font-medium text-card-foreground mb-1">
            Emergency Contact Name
          </label>
          <input
            type="text"
            name="emergency_contact_name"
            class="w-full bg-background border border-input rounded-md px-3 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent"
            value="{% if tenant %}{{ tenant.emergency_contact_name }}{% endif %}"
          />
        </div>

        <!-- Emergency Contact Phone -->
        <div>
          <label class="block text-sm font-medium text-card-foreground mb-1">
            Emergency Contact Phone
          </label>
          <div class="relative">
            <i data-lucide="phone" class="w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"></i>
            <input
              type="tel"
              name="emergency_contact_phone"
              class="w-full bg-background border border-input rounded-md pl-10 pr-3 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent"
              value="{% if tenant %}{{ tenant.emergency_contact_phone }}{% endif %}"
            />
          </div>
        </div>

        <!-- Employer -->
        <div>
          <label class="block text-sm font-medium text-card-foreground mb-1">
            Employer
          </label>
          <div class="relative">
            <i data-lucide="briefcase" class="w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"></i>
            <input
              type="text"
              name="employer"
              class="w-full bg-background border border-input rounded-md pl-10 pr-3 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent"
              value="{% if tenant %}{{ tenant.employer }}{% endif %}"
            />
          </div>
        </div>

        <!-- Monthly Income -->
        <div>
          <label class="block text-sm font-medium text-card-foreground mb-1">
            Monthly Income
          </label>
          <div class="relative">
            <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground">$</span>
            <input
              type="number"
              step="0.01"
              name="monthly_income"
              class="w-full bg-background border border-input rounded-md pl-7 pr-3 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent"
              value="{% if tenant and tenant.monthly_income %}{{ tenant.monthly_income }}{% endif %}"
              min="0"
            />
          </div>
        </div>

        <!-- Notes -->
        <div class="md:col-span-2">
          <label class="block text-sm font-medium text-card-foreground mb-1">
            Notes
          </label>
          <textarea
            name="notes"
            class="w-full bg-background border border-input rounded-md px-3 py-2 text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent"
            rows="3"
          >{% if tenant %}{{ tenant.notes }}{% endif %}</textarea>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="flex gap-3 pt-6 mt-6 border-t border-border">
        <button type="submit" class="inline-flex items-center gap-2 px-4 py-2 rounded-md font-medium transition-colors bg-primary text-primary-foreground hover:bg-primary/90">
          <i data-lucide="save" class="w-4 h-4"></i>
          Save Tenant
        </button>
        <a href="{% url 'rentals:tenant-list' %}" class="inline-flex items-center gap-2 px-4 py-2 rounded-md font-medium transition-colors bg-muted text-muted-foreground hover:bg-accent border border-border">
          <i data-lucide="x" class="w-4 h-4"></i>
          Cancel
        </a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
